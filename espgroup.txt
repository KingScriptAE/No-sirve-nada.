local Players = game:GetService("Players")

local RANK_OWNER = 255
local RANK_VICE_PRESIDENT = 250
local RANK_ADMIN = 200
local function createESP(player, color, labelText)
	player.CharacterAdded:Connect(function(character)
		task.wait(0.5)
		
		local highlight = Instance.new("Highlight")
		highlight.Name = "GroupESP"
		highlight.FillColor = color
		highlight.OutlineColor = Color3.new(1, 1, 1)
		highlight.FillTransparency = 0.5
		highlight.Adornee = character
		highlight.Parent = character
		
		local bgui = Instance.new("BillboardGui")
		bgui.Name = "RoleTag"
		bgui.Size = UDim2.new(0, 200, 0, 50)
		bgui.StudsOffset = Vector3.new(0, 4, 0)
		bgui.AlwaysOnTop = true
		
		local label = Instance.new("TextLabel")
		label.BackgroundTransparency = 1
		label.Size = UDim2.new(1, 0, 1, 0)
		label.Text = "[" .. labelText .. "] " .. player.Name
		label.TextColor3 = color
		label.TextScaled = true
		label.Font = Enum.Font.SourceSansBold
		label.TextStrokeTransparency = 0
		label.Parent = bgui
		
		bgui.Parent = character
	end)
end

local function checkPlayerRank(player)
	 if player == Players.LocalPlayer then return end

	local rank = player:GetRankInGroup(TARGET_GROUP_ID)
	local roleName = player:GetRoleInGroup(TARGET_GROUP_ID)

	if rank == RANK_OWNER then
		createESP(player, Color3.fromRGB(255, 215, 0), "群主")
	elseif rank >= RANK_VICE_PRESIDENT then
		createESP(player, Color3.fromRGB(170, 0, 255), "副会长")
	elseif rank >= RANK_ADMIN then
		createESP(player, Color3.fromRGB(0, 170, 255), "管理员")
	end
end

Players.PlayerAdded:Connect(checkPlayerRank)

for _, player in ipairs(Players:GetPlayers()) do
	checkPlayerRank(player)
end